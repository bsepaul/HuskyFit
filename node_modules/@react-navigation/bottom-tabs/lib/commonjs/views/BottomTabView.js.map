{"version":3,"names":["BottomTabView","props","tabBar","state","navigation","descriptors","safeAreaInsets","detachInactiveScreens","Platform","OS","sceneContainerStyle","focusedRouteKey","routes","index","key","loaded","setLoaded","React","useState","includes","dimensions","SafeAreaProviderCompat","initialMetrics","frame","tabBarHeight","setTabBarHeight","getTabBarHeight","layout","width","height","insets","style","options","tabBarStyle","renderTabBar","top","right","bottom","left","styles","container","map","route","descriptor","lazy","unmountOnBlur","isFocused","freezeOnBlur","header","getHeaderTitle","name","headerShown","headerStatusBarHeight","headerTransparent","StyleSheet","absoluteFill","zIndex","render","create","flex","overflow"],"sources":["BottomTabView.tsx"],"sourcesContent":["import {\n  getHeaderTitle,\n  Header,\n  SafeAreaProviderCompat,\n  Screen,\n} from '@react-navigation/elements';\nimport type {\n  ParamListBase,\n  TabNavigationState,\n} from '@react-navigation/native';\nimport * as React from 'react';\nimport { Platform, StyleSheet } from 'react-native';\nimport { SafeAreaInsetsContext } from 'react-native-safe-area-context';\n\nimport type {\n  BottomTabBarProps,\n  BottomTabDescriptorMap,\n  BottomTabHeaderProps,\n  BottomTabNavigationConfig,\n  BottomTabNavigationHelpers,\n  BottomTabNavigationProp,\n} from '../types';\nimport BottomTabBarHeightCallbackContext from '../utils/BottomTabBarHeightCallbackContext';\nimport BottomTabBarHeightContext from '../utils/BottomTabBarHeightContext';\nimport BottomTabBar, { getTabBarHeight } from './BottomTabBar';\nimport { MaybeScreen, MaybeScreenContainer } from './ScreenFallback';\n\ntype Props = BottomTabNavigationConfig & {\n  state: TabNavigationState<ParamListBase>;\n  navigation: BottomTabNavigationHelpers;\n  descriptors: BottomTabDescriptorMap;\n};\n\nexport default function BottomTabView(props: Props) {\n  const {\n    tabBar = (props: BottomTabBarProps) => <BottomTabBar {...props} />,\n    state,\n    navigation,\n    descriptors,\n    safeAreaInsets,\n    detachInactiveScreens = Platform.OS === 'web' ||\n      Platform.OS === 'android' ||\n      Platform.OS === 'ios',\n    sceneContainerStyle,\n  } = props;\n\n  const focusedRouteKey = state.routes[state.index].key;\n  const [loaded, setLoaded] = React.useState([focusedRouteKey]);\n\n  if (!loaded.includes(focusedRouteKey)) {\n    setLoaded([...loaded, focusedRouteKey]);\n  }\n\n  const dimensions = SafeAreaProviderCompat.initialMetrics.frame;\n  const [tabBarHeight, setTabBarHeight] = React.useState(() =>\n    getTabBarHeight({\n      state,\n      descriptors,\n      dimensions,\n      layout: { width: dimensions.width, height: 0 },\n      insets: {\n        ...SafeAreaProviderCompat.initialMetrics.insets,\n        ...props.safeAreaInsets,\n      },\n      style: descriptors[state.routes[state.index].key].options.tabBarStyle,\n    })\n  );\n\n  const renderTabBar = () => {\n    return (\n      <SafeAreaInsetsContext.Consumer>\n        {(insets) =>\n          tabBar({\n            state: state,\n            descriptors: descriptors,\n            navigation: navigation,\n            insets: {\n              top: safeAreaInsets?.top ?? insets?.top ?? 0,\n              right: safeAreaInsets?.right ?? insets?.right ?? 0,\n              bottom: safeAreaInsets?.bottom ?? insets?.bottom ?? 0,\n              left: safeAreaInsets?.left ?? insets?.left ?? 0,\n            },\n          })\n        }\n      </SafeAreaInsetsContext.Consumer>\n    );\n  };\n\n  const { routes } = state;\n\n  return (\n    <SafeAreaProviderCompat>\n      <MaybeScreenContainer\n        enabled={detachInactiveScreens}\n        hasTwoStates\n        style={styles.container}\n      >\n        {routes.map((route, index) => {\n          const descriptor = descriptors[route.key];\n          const { lazy = true, unmountOnBlur } = descriptor.options;\n          const isFocused = state.index === index;\n\n          if (unmountOnBlur && !isFocused) {\n            return null;\n          }\n\n          if (lazy && !loaded.includes(route.key) && !isFocused) {\n            // Don't render a lazy screen if we've never navigated to it\n            return null;\n          }\n\n          const {\n            freezeOnBlur,\n            header = ({ layout, options }: BottomTabHeaderProps) => (\n              <Header\n                {...options}\n                layout={layout}\n                title={getHeaderTitle(options, route.name)}\n              />\n            ),\n            headerShown,\n            headerStatusBarHeight,\n            headerTransparent,\n          } = descriptor.options;\n\n          return (\n            <MaybeScreen\n              key={route.key}\n              style={[StyleSheet.absoluteFill, { zIndex: isFocused ? 0 : -1 }]}\n              visible={isFocused}\n              enabled={detachInactiveScreens}\n              freezeOnBlur={freezeOnBlur}\n            >\n              <BottomTabBarHeightContext.Provider value={tabBarHeight}>\n                <Screen\n                  focused={isFocused}\n                  route={descriptor.route}\n                  navigation={descriptor.navigation}\n                  headerShown={headerShown}\n                  headerStatusBarHeight={headerStatusBarHeight}\n                  headerTransparent={headerTransparent}\n                  header={header({\n                    layout: dimensions,\n                    route: descriptor.route,\n                    navigation:\n                      descriptor.navigation as BottomTabNavigationProp<ParamListBase>,\n                    options: descriptor.options,\n                  })}\n                  style={sceneContainerStyle}\n                >\n                  {descriptor.render()}\n                </Screen>\n              </BottomTabBarHeightContext.Provider>\n            </MaybeScreen>\n          );\n        })}\n      </MaybeScreenContainer>\n      <BottomTabBarHeightCallbackContext.Provider value={setTabBarHeight}>\n        {renderTabBar()}\n      </BottomTabBarHeightCallbackContext.Provider>\n    </SafeAreaProviderCompat>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    overflow: 'hidden',\n  },\n});\n"],"mappings":"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"}